#!/bin/bash

[[ -z ELASTIC_URL ]] && ELASTIC_URL=localhost:9200

install_dir=$(cd $(dirname $0) && cd .. && pwd)

new_index="types"

curl -f -XPUT $ELASTIC_URL/${new_index} -d '
{ 
 "settings" : {
  "analysis" : {
   "analyzer" : {
    "french_type" : {
     "type" : "custom",
     "tokenizer" : "standard",
     "filter" : ["asciifolding", "lowercase", "synonyms_french_type", "unique"]
    }
   },
   "filter" : {
    "synonyms_french_type" : {
     "type" : "synonym",
     "synonyms" : [
      "appart,app,appt,studio,duplex,loft => appartement",
      "t1,t1bis,t2,t3,t4,t5,f2,f3,f4,f5 => appartement",
      "residence,plateau,studette => appartement",
      "appartements => appartement",
      "pavillon,pavilon,villa,propriete => maison",
      "contemporaine,comtemporaine => maison",
      "chateau,ferme,grange,landaise,bergerie => maison",
      "demeure,gite,echoppe,batisse,battisse => maison",
      "maisonette,maisonnette,fermette => maison",
      "traditionnelle,traditonnelle,longere,chalet => maison",
      "perigourdine,chartreuse,girondine => maison",
      "arcachonnaise,arcachonaise => maison",
      "bearnaise,neo-bearnaise,basquaise => maison",
      "cottage,resiniere,girolle => maison",
      "hotel particulier => maison",
      "ossature bois => maison",
      "plain pied => maison",
      "plein pied => maison",
      "maisons => maison",
      "terrains,parcelle,lotissement => terrain",
      "beauterrain,terr => terrain",
      "a batir => terrain"
     ]
    }
   }
  }
 },
 "mappings" : {
  "type" : {
   "properties" : {
    "type" : { "type" : "string"},
    "french" : { "type" : "string", "analyzer" : "french_type"}
   }
  }
 }
}'

curl -f -XPUT $ELASTIC_URL/${new_index}/type/flat -d '
{
  "type":"flat",
  "french":"appartement"
}'

curl -f -XPUT $ELASTIC_URL/${new_index}/type/house -d '
{
 "type":"house",
 "french":"maison"
}'

curl -f -XPUT $ELASTIC_URL/${new_index}/type/field -d '
{
 "type":"field",
 "french":"terrain"
}'

